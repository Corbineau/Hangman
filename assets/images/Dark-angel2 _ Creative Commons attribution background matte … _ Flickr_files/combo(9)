YUI.add("hermes-lang-upload-blocking",function(o,e){o.Intl.add("hermes/upload-blocking","en-US",{UPLOADS_LOCKED_SOON:["Your uploads will be locked soon."],FREE_ACCOUNTS_NO_LONGER_UPLOAD:["Starting January 8th, free accounts on Flickr with ","${limitCount}"," photos or more will no longer be able to upload new photos."],LEARN_MORE_ABOUT_CHANGES_HERE:["Learn more about these changes here."],UPGRADE_TO_GET_UNLIMITED:["For unlimited uploads, upgrade to Pro at ","${percentOff}","% off using code ","${couponCode}","."],FREE_ACCOUNTS_NO_LONGER_UPLOAD_2:["Starting January 8, 2019 free accounts on Flickr with ","${limitCount}"," photos or more will no longer be able to upload new photos. Starting February 5, 2019 some items over the limit will be at risk of deletion."],FREE_ACCOUNTS_NO_LONGER_UPLOAD_BY_1_8_2019:["Starting January 8th, free accounts on Flickr with ","${limitCount}"," or more photos and videos will no longer be able to upload new content."],UPGRADE_TO_GET_UNLIMITED_BY_1_8_2019:["For unlimited uploads, upgrade to Pro at ","${percentOff}","% off using code ","${couponCode}",". (Discount valid until January 8, 2019)"],OVER_UPLOAD_LIMIT_HEAD:["Your photos are at risk of deletion soon."],OVER_UPLOAD_LIMIT_COPY:['Your Free Flickr account is <a href="',"${limitedImagesUrl}",'" target="_blank">limited to ',"${limitCount}",'</a> photos or videos. Your uploads are now locked, and starting February 5th, the oldest items over the limit for free accounts will be at risk of deletion. To unlock uploads and protect your photos and videos, you’ll need to remove items until you’re under the account limit or <a href="',"${upgradeToProUrl}",'">upgrade to Flickr Pro</a> for unlimited storage.'],AT_UPLOAD_LIMIT_HEAD:["Your uploads are now locked."],AT_UPLOAD_LIMIT_COPY:['Your Free Flickr account is <a href="',"${limitedImagesUrl}",'" target="_blank">limited to ',"${limitCount}",'</a> photos or videos. Starting February 5th, the oldest items over your free account limit will be at risk of deletion. However, any items licensed Creative Commons (or other free license types) before November 1, 2018 will not be deleted. To upload new photos or videos, you’ll need to remove items until you’re under the account limit or you can <a href="',"${upgradeToProUrl}",'">upgrade to Flickr Pro</a> for unlimited uploads.'],UPLOADS_LOCKED_SOON_HEAD:["Your uploads will be locked soon."],UPLOADS_LOCKED_SOON_COPY:['You are nearing your <a href="',"${limitedImagesUrl}",'" target="_blank">',"${limitCount}"," item Free Flickr account limit</a>. To upload more than ","${limitCount}",' photos or videos, you’ll need to <a href="',"${upgradeToProUrl}",'">upgrade to Flickr Pro</a> for unlimited uploads.'],YOU_CAN_UPLOAD_COUNT_MORE:[{type:"plural",valueName:"photoCount",options:{one:["You can upload ","${countString}"," more photo or video."],other:["You can upload ","${countString}"," more photos and videos."]}}],MORE_THAN_LIMIT_ITEMS_TO_UPLOAD:[{type:"plural",valueName:"photoCount",options:{one:["Looks like there is more than ","${countString}"," item to upload. We’ll upload the first ","${countString}"," from your batch."],other:["Looks like there are more than ","${countString}"," items to upload. We’ll upload the first ","${countString}"," from your batch."]}}],NEVERMIND:["Nevermind"],OK_GO_AHEAD:["Ok go ahead"],UPLOAD_QUEUE_FULL:["Your upload queue is full!"],GET_PRO_FOR_UNLIMITED:["Get Pro for unlimited uploads"],NOT_NOW:["Not now"],UPLOAD_YOUVE_REACHED_LIMIT_GET_PRO:["You’ve reached the 1000 item upload limit. Get Pro for unlimited uploads."],YOUVE_REACHED_UPLOAD_LIMIT:["You’ve reached the ","${limitCount}"," item upload limit."],AT_UPLOAD_LIMIT_COPY_SHORT:['Your Free Flickr account is <a href="',"${limitedImagesUrl}",'" target="_blank">limited to ',"${limitCount}"," photos or videos</a>. To upload more than ","${limitCount}"," items, you’ll need to upgrade to Flickr Pro for unlimited storage."],OVER_UPLOAD_LIMIT_COPY_SHORT:['Your Free Flickr account is <a href="',"${limitedImagesUrl}",'" target="_blank">limited to ',"${limitCount}"," photos or videos</a>. Starting February 5th, the oldest items over the limit will be at risk of deletion. Upgrade to Flickr Pro for unlimited storage."],PHOTO_EDITOR_REACHED_UPLOAD_LIMIT:["You’ve reached your ","${limitCount}",' item limit. To save a new copy, <a href="',"${upgradeToProUrl}",'" target="_blank">upgrade to Flickr Pro</a>.'],OVER_UPLOAD_LIMIT_EXTEND_HEAD:["Update: Free Flickr account limit deadline extension."],OVER_UPLOAD_LIMIT_EXTEND_COPY:["We’re extending the deadline for upgrading to Flickr Pro for unlimited storage or removing your photos/videos to meet the new ","${limit}"," item limit. The new deadline is March ","${dateNumber}",", 2019."],ALL_YOUR_PHOTOS_MATTER:['<span class="all-text">ALL</span> your photos matter.'],UPLOAD_LIMIT_EXTEND_MODAL_1:["We know the recent update limiting photo and video uploads to ","${limit}"," for free Flickr accounts was a big one. We’ve heard loud and clear from our Flickr photographers that you need more time to make sure your photos are safe."],UPLOAD_LIMIT_EXTEND_MODAL_2:["Whether you’re upgrading to Flickr Pro for unlimited photo storage or downloading photos to meet the new limit, we’re extending the deadline to March ","${dateNumber}",", 2019."],LIMIT_OVERLAY_STATS_DISAPPEAR_VIEWS_FAVES_TAGS:["This includes some of the ","${views}"," views, ","${faves}"," faves, and ","${tags}"," tags attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_VIEWS:["This includes some of the ","${views}"," views attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_FAVES:["This includes some of ","${faves}"," faves attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_VIEWS_FAVES:["This includes some of the ","${views}"," views and ","${faves}"," faves attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_TAGS:["This includes some of the ","${tags}"," tags attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_VIEWS_TAGS:["This includes some of the ","${views}"," views and ","${tags}"," tags attached to those photos."],LIMIT_OVERLAY_STATS_DISAPPEAR_FAVES_TAGS:["This includes some of the ","${faves}"," faves and ","${tags}"," tags attached to those photos."],RIGHT_NOW_PHOTOS_AT_RISK:["Right now ","${count}"," of your photos are at risk of deletion."],TAKE_MOMENT_TO_PROTECT_PHOTOS:["Please take a moment to protect the photos in your account."],PROTECT_THESE_PHOTOS:["Protect these photos."],SAVE_YOUR_PHOTOS:["Save your photos"],CONTINUE_WITHOUT_SECURING_PHOTOS:["Continue without securing ","${count}"," photos."],CONTINUE_WITHOUT_SECURING_PHOTOS_B:["Continue without securing ","${count}"," photos"],MARK_PHOTOS_FOR_DELETION:["No, mark ","${count}"," for deletion."],MARK_PHOTOS_FOR_DELETION_B:["No, mark ","${count}"," for deletion"],DONT_REMIND_AGAIN:["Don’t remind me again."],DONT_REMIND_AGAIN_B:["Don’t remind me again"],CHOOSE_ABOVE_TO_CONTINUE:["Choose an option above to continue to your photos."],DID_YOU_KNOW_FLICKR_PRO:["Did you know Flickr Pro is more than just unlimited storage?"],UPGRADE_YOU_ALSO_GET:["You also get ad-free browsing, priority support from our Support Heroes, and you will save money with exclusive discounts on photo books, software, and gear from our industry partners."],DONT_NEED_TO_BE_PROFESSIONAL:["You don’t need to be a professional to be a Flickr Pro."],FLICKR_PROS_LOVE_PHOTOGRAPHY:["Flickr Pros love photography, plain and simple. By joining Flickr Pro, you’ll join a community of people who enjoy talking, sharing, and discovering photos as much as you do."],JOIN_FLICKR_PRO:["Join Flickr Pro"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-refencing-announcement",function(e,o){e.Intl.add("hermes/refencing-announcement","en-US",{LETS_BE_CANDID:["Let’s be candid."],FLICKR_AT_ITS_BEST:["Flickr at its best is a place to connect, to discover, and to evolve as photographers and lovers of photography. This is the world’s largest photographer-focused community. Here, together, this newly-independent community can shape the future of photography itself."],TODAY_WE_ARE_ANNOUNCING:["Today we are announcing updates to Flickr’s Pro and Free account offerings."],FLICKR_PRO_BETTER_THAN_EVER:['<span class="flickr-pro-text">Flickr Pro</span> is better than ever. For only ',"${price}",' per year, get <span class="unlimited-storage-text">unlimited storage</span>, ad-free browsing, advanced stats, an unmatched community, and more.'],UNLIMITED_STORAGE:["Unlimited Storage."],ONLY_LIMIT_IS_IMAGINATION:["The only limit is your imagination. Upload as many photos as you can take, always at true full resolution."],AD_FREE_BROWSING:["Ad-free Browsing."],FOCUS_ON_WHAT_MATTERS:["Focus on what matters. A fully ad-free Flickr experience for you and your visitors."],ADVANCED_STATS:["Advanced Stats."],SEE_WHICH_PHOTOS_ARE_TRENDING:["See which of your photos are trending now, and which have performed the best over the life of your Flickr Pro account."],PLUS_ALL_THESE_PRO_FEATURES:['Plus all these great <span class="new-text">new</span> Pro-only features.'],PREMIER_SUPPORT:["Premier Support"],PREMIER_PRODUCT_SUPPORT:["Premier Product Support"],SKIP_THE_LINE:['Skip the line. Flickr Pros now receive priority assistance from our new world-class support team. <span class="when-text">Available now.</span>'],MORE_PARTNER_DISCOUNTS:["More Partner Discounts"],SAVE_ON_PHOTOGRAPHY_ESSENTIALS:["Save on photography essentials. Discounts on Creative Cloud from Adobe, ","${smPercent}",'% off a custom portfolio site on SmugMug, gear from Peak Design, and many more. <span class="when-text">Coming November.</span>'],ADVANCED_STATS_ON_MOBILE:["Advanced Stats on Mobile"],STATS_IN_YOUR_POCKET:['Stats in your pocket. All the photo stats you know and love, available in-app. <span class="when-text">Coming November.</span>'],INCREASED_EXPOSURE:["Increased Exposure"],ALL_PROS_PRIORITY_EXPOSURE:['All Pro members as of January 1, 2019 are eligible for priority exposure in the next iteration of Explore. <span class="when-text">Coming early 2019.</span>'],NEW_5K_PHOTO_OPTION:["New 5K Photo Display Option"],LOOK_YOUR_BEST:['Look your best. Your images are beautifully optimized for any screen, from smartphone to jumbotron. Pro images display at resolutions up to 5K. <span class="when-text">Coming early 2019.</span>'],TEN_MINUTE_VIDEOS:["10 Minute Videos"],MORE_TIME_TO_TELL_STORY:['More time to tell your story. Play back videos for up to 10 minutes, increased from 3. <span class="when-text">Coming early 2019.</span>'],HANDS_DOWN_BEST_DEAL:["Hands down the best deal in photos."],BEST_DEAL_REASON:["Unlimited storage, ad-free browsing, and a global community of over 100 million photographers for less than half the cost of Apple, Amazon, or Google. Sign up today and get ","${percent}","% off the first year. Discount available through November 30."],GET_PRO_30_OFF:["Get Pro today for ","${percent}","% off"],FREE_ACCOUNTS_1000_PHOTOS:['<span class="free-accounts-text">Free accounts</span> will soon be limited to 1,000 photos or videos. Flickr isn’t Flickr without the contributions and participation of our free members, and we remain committed to a vibrant free offering.'],IF_YOU_ARE_FREE_MEMBER:["If you are a free member with more than 1,000 photos or videos, you will have ample time to upgrade to Pro (for ","${percent}",'% off your first year) or download your photos and videos.<a href="',"${url}",'" title="',"${title}",'">*</a>'],READ_MORE_ABOUT_DECISION:["Read more about this decision."],YOUR_PHOTOGRAPHY_COMMUNITY:["Your Photography Community"],SHARE_DISCOVER_GROW:["Share, discover, and grow. No matter your passion, there are photographers here who share it."],ORGANIZE_BEAUTIFULLY:["Organize Beautifully"],POWERFUL_INTUITIVE_TOOLS:["Powerful, intuitive tools to organize your photos and share them with the people who matter to you."],FREE_MEMBERS_NOTICE:["*Free members with more than 1,000 photos or videos uploaded to Flickr have until Tuesday, January 8, 2019, to upgrade to Pro or download content over the limit. After January 8, 2019, members over the limit will no longer be able to upload new photos to Flickr. After February 5, 2019, free accounts that contain over 1,000 photos or videos will have content actively deleted -- starting from oldest to newest date uploaded -- to meet the new limit."],READY_FOR_PRO:["Ready for Pro?"],NEW_PROS_RECEIVE_DISCOUNT:["New Pros receive ","${percent}","% off their first year. Discounted price available until Nov 30."],UPGRADE_TO_PRO:["Upgrade to Pro"],NEW_SIMPLE_LOGIN:["New simple login!"],COMING_IN_JANUARY_LOGIN:["Coming in January, there will be no need for a Yahoo account to use Flickr."],ANNOUNCEMENT_BANNER_ACCOUNTS_CHANGING:["Flickr’s Pro and Free account offerings are changing. See what it means for you."],SAVE_ON_PHOTOGRAPHY_ESSENTIALS_NOW:["Save on photography essentials. Discounts on Creative Cloud from Adobe, ","${smPercent}",'% off a custom portfolio site on SmugMug, gear from Peak Design, and many more. <span class="when-text">Available Now.</span>'],STATS_IN_YOUR_POCKET_NOW:['Stats in your pocket. All the photo stats you know and love, available in-app. <span class="when-text">Available Now.</span>'],BEST_DEAL_REASON_JAN:["Unlimited storage, ad-free browsing, and a global community of over 100 million photographers for less than half the cost of Apple, Amazon, or Google. Sign up today and get ","${percent}","% off the first year. Discount available through January 8."],BEST_DEAL_REASON_JAN_X:["Unlimited storage, ad-free browsing, and a global community of over 100 million photographers for less than half the cost of Apple, Amazon, or Google. Sign up today and get ","${percent}","% off the first year. Discount available through January ","${dateNumber}","."],NEW_PROS_RECEIVE_DISCOUNT_JAN:["New Pros receive ","${percent}","% off their first year. Discounted price available until January 8."],NEW_PROS_RECEIVE_DISCOUNT_JAN_X:["New Pros receive ","${percent}","% off their first year. Discounted price available until January ","${dateNumber}","."],WE_ARE_ANNOUNCING:["We are announcing updates to Flickr’s Pro and Free account offerings."],ALL_PROS_PRIORITY_EXPOSURE_2:["All Pro members are eligible for priority exposure in the next iteration of Explore. Coming early 2019."],BEST_DEAL_REASON_2:["Unlimited storage, ad-free browsing, and a global community of more than 100 million photographers for less than half the cost of Apple, Amazon, or Google."],GET_PRO_TODAY:["Get Pro today"],IF_YOU_ARE_FREE_MEMBER_2:["If you are a free member with more than ","${limitCount}"," photos or videos, you will have ample time to upgrade to Pro or download your photos and videos.*"],FREE_MEMBERS_NOTICE_2:["*Free members with more than ","${limitCount}"," photos or videos uploaded to Flickr have until Tuesday, January 8, 2019, to upgrade to Pro or download content over the limit. After January 8, 2019, members over the limit will no longer be able to upload new photos to Flickr. On February 5, 2019, photos and videos over the free account ","${limitCount}"," item limit will be at risk of deletion beginning with the oldest photos and videos."],JOIN_LARGEST_COMMUNITY:["Join the largest, most influential group of photographers on the planet, and find your community today."],COMING_SOON_LOGIN:["Coming soon, there will be no need for a Yahoo account to use Flickr."]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-vr-overlay",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,t,s){return'<a class="close"><span></span></a>'},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/vr-overlay",function(a,s){return s=s||{},s.partials=s.partials?e.merge(t,s.partials):t,r(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-flickr-balls",function(e,a){var l=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,l,r,s){return'<div class="balls">\n\t<div class="blue ball"></div><div class="pink ball"></div>\n</div>'},useData:!0}),r={};e.Array.each([],function(a){var l=e.Template.get("hermes/"+a);l&&(r[a]=l)}),e.Template.register("hermes/flickr-balls",function(a,s){return s=s||{},s.partials=s.partials?e.merge(r,s.partials):r,l(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("flickr-photos-removeTag-deletor",function(o,e){"use strict";o.namespace("ModelDeletors")["flickr-photos-removeTag"]={run:function(r,t){var i={};return"string"==typeof r?i.tag_id=r:"object"==typeof r&&(i.global_tag_ids=r.globalTagIds.join(","),i.photo_ids=r.photoIds.join(",")),t.callAPI("flickr.photos.removeTag",i).then(null,o.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("tag-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{create:function(e){return t.ModelCreators["flickr-photos-addTags"].run(e,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-removeTag"].run(e,this.appContext)}},attributes:{tagValue:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e.trim().replace(/\s/g,""))}},tagRaw:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}},tagAuthorNSID:{},isMachineTag:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},url:{derivedBy:["tagValue"],readOnly:!0,defaultFn:function(t){var e=this.getValue(t,"tagValue");return e?"/photos/tags/"+e:void 0}},searchUrl:{derivedBy:["tagValue","tagRaw","isMachineTag"],readOnly:!0,defaultFn:function(t){var e,r=this.getValue(t,"tagRaw"),a=this.getValue(t,"tagValue"),i=this.getValue(t,"isMachineTag");return r&&i?(r.indexOf(" ")>0&&(e=r.indexOf("=")+1,r=r.substring(0,e)+'"'+r.substring(e)+'"'),"/search/?tags="+r):a?"/search/?tags="+a:void 0}},duplicateAutotagId:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});YUI.add("flickr-tags-getListPhoto-fetcher",function(t,o){"use strict";t.namespace("ModelFetchers")["flickr-tags-getListPhoto"]={run:function(a,e){var s=a.id,g={photo_id:s,extras:"autotags",lang:e.lang},r=this;return t.Promise.all([e.callAPI("flickr.tags.getListPhoto",g),e.getModelRegistry("photo-tags-models"),e.getModelRegistry("tag-models"),e.getModelRegistry("photo-autotags-models"),e.getModelRegistry("autotag-models")]).then(function(t){return r._processResponse(t,s,e.flipper)},t.FetcherErrorLogger(o))},_processResponse:function(o,a,e){var s,g=o[0],r=o[1],i=o[2],n=g.photo&&g.photo.tags&&void 0!==g.photo.tags.tag?g.photo.tags.tag.length:0,p=[],u=o[3],d=o[4],h=0,l=[];return n>0&&t.Array.each(g.photo.tags.tag,function(t){"string"==typeof t.content&&p.push(i.addOrUpdate({id:t.id,tagRaw:t.raw,tagValue:t.content,tagAuthorNSID:t.author,isMachineTag:t.machineTag,duplicateAutotagId:t.duplicateAutotag}))}),r.exists(a)?r.setValue(a,"tags",p):r.add({id:a,tags:p}),s={id:a},g.photo&&g.photo.autotags&&void 0!==g.photo.autotags.autotag&&(h=g.photo.autotags.autotag.length),h>0&&t.Array.each(g.photo.autotags.autotag,function(t){"string"==typeof t.content&&l.push(d.addOrUpdate({id:t.id,autotagValue:t.content,score:t.confidence,isPrivate:t.private}))}),s.autotags={page:1,perPage:1e3,pageContent:l,totalItems:h},u.exists(a)?u.setValue(a,"autotags",s.autotags):u.add(s),r.proxy(a)}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["tag-models","photo-tags-models"]});YUI.add("photo-tags-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-tags-getListPhoto"].run(e,this.appContext)},create:function(e){return t.ModelCreators["flickr-photos-addTags"].run(e,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-removeTag"].run(e,this.appContext)}},attributes:{tags:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-tags-getListPhoto-fetcher","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});YUI.add("flickr-photos-addTags-creator",function(t,o){"use strict";t.namespace("ModelCreators")["flickr-photos-addTags"]={run:function(s,e){var r=this;return t.Promise.all([e.callAPI("flickr.photos.addTags",this._processParams(s)),e.getModelRegistry("photo-tags-models"),e.getModelRegistry("tag-models")]).then(function(t){return r._processResponse(t,s)},function(t){throw s.fullResponse&&(t.photoIds=s.photoId),t}).then(null,t.FetcherErrorLogger(o))},_processParams:function(t){t.tags=t.tags||[];var o={};return o.photo_ids=t.photoId.join(","),o.tags=t.tags.join(","),t.fullResponse&&(o.full_response=1),o.extras="is_autotag",o},_processResponse:function(t,o){var s,e,r,a=t[0],n=t[1],i=t[2],d=[];if(s=a.errors,!o.fullResponse){for(a.tags.tag.forEach(function(t){i.exists(t.id)||i.add({id:t.id,tagRaw:t.raw,tagValue:t.content.replace(/\s/g,""),tagAuthorNSID:t.author,duplicateAutotagId:t.duplicateAutotag}),d.push(i.proxy(t.id))}),e=0;e<o.photoId.length;e++)r=o.photoId[e],n.exists(r)?d.forEach(function(t){void 0!==t&&n.getValue(r,"tags").push(t)}):n.add({id:r,tags:d});return d}if(s&&s.length>0)return s}}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-tags-models","tag-models"]});YUI.add("flickr-favorites-getContext-fetcher",function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getContext",this._processParams(t),!0),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw 3===e.code&&"Photo not a favorite"===e.message&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(o))},_processParams:function(o){var t={photo_id:o.photoId,num_prev:o.numNext,num_next:o.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return o.id?t.user_id=o.id:t.path_alias=o.pathAlias,t},_processResponse:function(o,t){var s,r,n,a,p,i,l=o[0],h=o[1],d=o[2],g=o[3],u=o[4],m=o[5],c=[],x=[],y=d.proxy(t.photoId),M=[];return s=l.prevphotos,r=l.nextphotos,x=e.APIHelper.response.parsePhotos({photos:s.photo,personModelRegistry:g,photoModelRegistry:d,photoEngagementModelRegistry:u,photoStatsModelRegistry:m}),c=e.APIHelper.response.parsePhotos({photos:r.photo,personModelRegistry:g,photoModelRegistry:d,photoEngagementModelRegistry:u,photoStatsModelRegistry:m}),i=h.getValue(t.id,"photoContextList"),a=!!i.hasMinBoundary&&i.hasMinBoundary(),p=!!i.hasMaxBoundary&&i.hasMaxBoundary(),n=i.getList(),M=e.APIHelper.response.addOrReplaceListByContext({model:y,next:x,prev:c.reverse(),hasMax:p,hasMin:a,current:n,numNext:t.numNext,numPrev:t.numPrev}),h.setValue(t.id,"photoContextList",M),{next:x,previous:c.reverse()}}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});YUI.add("flickr-favorites-getList-fetcher",function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getList"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getList",this._processParams(t)),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models"),s.getModelRegistry("gallery-photo-association-models"),s.getModelRegistry("gallery-faves-models")]).then(function(e){return r._processResponse(e,t)},e.FetcherErrorLogger(o))},_processParams:function(o){var t={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:o.perPage||20,page:o.page||1,get_user_info:1,jump_to:o.withPhotoId||""};if(o.id||o.userId)t.user_id=(o.id||o.userId).split("-")[0];else{if(!o.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");t.path_alias=o.pathAlias}return o.galleryId&&(t.gallery_id=o.galleryId),t},_processResponse:function(o,t){var s,r,a,p=o[0],l=o[1],i=o[2],d=o[3],g=o[4],h=o[5],n=o[6],y=o[7],c={id:p.user.nsid,pathAlias:p.user.pathAlias,totalItems:p.photos.total},u=t.id||t.userId,f=[];return u&&u!==c.id&&(c.id=u),r=e.APIHelper.response.parsePerson(p.user),c.owner=i.addOrUpdate(r),t.galleryId?(p.photos.photo.forEach(function(e){e.gallerynotaddable&&f.push(e)}),s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),a=e.APIHelper.response.parsePhotos({photos:f,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},c.id=r.id+"-"+t.galleryId,y.addOrUpdate(c).getValue("nonGalleryAddablePhotos").concat(a)):(s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoPageList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},d.addOrUpdate(c)),p.photos.photo&&p.photos.photo.forEach(function(e){e.ingallery&&n.addOrUpdate({id:t.galleryId+"-"+e.id,galleryId:t.galleryId,photoId:e.id})}),s}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","favorite-models","photo-engagement-models","photo-stats-models"]});YUI.add("favorite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-favorites-getList"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"favorites"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),i=this.getValue(e,"normalizedId");return r&&r.nsid===i?"Your favorites":(t=this.getValue(e,"owner"))?t.getValue("displayname")+"'s favorites":"Favorites"}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-favorites-getList"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-favorites-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/favorites/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){return"faves-"+this.getValue(e,"owner").getValue("pathAlias")}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-favorites-getContext-fetcher","flickr-favorites-getList-fetcher","photo-model-helper"]});YUI.add("flickr-galleries-getInfo-fetcher",function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-galleries-getInfo"]={run:function(o,t){var n=this,s=this._processParams(o);return e.FlickrPromise({apiResponse:t.callAPI("flickr.galleries.getInfo",s),galleryInfoModelRegistry:t.getModelRegistry("gallery-info-models"),personModelRegistry:t.getModelRegistry("person-models")}).then(function(e){return n._processResponse(e,o,t)},e.FetcherErrorLogger(r))},_processResponse:function(e,r,o){var t,n,s=e.apiResponse,i=e.galleryInfoModelRegistry,a=(e.personModelRegistry,e.personModel,s.gallery);if(a)return o.getModel("person-models",a.owner).then(function(e){return n=e,t={id:r.id,compoundId:a.id,owner:n,username:a.username,primaryPhotoId:a.primary_photo_id,dateCreate:parseInt(a.date_create),dateUpdate:parseInt(a.date_update),photoCount:a.count_photos,videoCount:a.count_videos,viewCount:parseInt(a.count_views),commentCount:parseInt(a.count_comments),title:a.title._content,description:a.description._content,currentState:a.current_state,primary_photo_server:a.primary_photo_server,primary_photo_farm:a.primary_photo_farm,primary_photo_secret:a.primary_photo_secret},i.addOrUpdate(t)})},_processParams:function(e){return{gallery_id:e.id}}}},"@VERSION@",{requires:["flickr-promise","api-helper","url-helper"],optional:["gallery-info-models","person-models"]});YUI.add("flickr-galleries-comments-addComment-creator",function(e,t){"use strict";e.namespace("ModelCreators")["flickr-galleries-comments-addComment"]={run:function(n,r){var o=this;return e.Promise.all([r.callAPI("flickr.galleries.comments.addComment",this._processParams(n)),r.getModelRegistry("person-models"),r.getModelRegistry("gallery-comment-models"),r.getModel("gallery-info-models",n.galleryId)]).then(function(e){return o._processResponse(e,n,r)},e.FetcherErrorLogger(t))},_processParams:function(e){return{gallery_id:e.galleryId,comment_text:e.commentText,user_id:e.galleryOwnerId,extras:"full_response, expand_bbml"}},_processResponse:function(e,t,n){var r,o,m,a=e[0],l=(e[1],e[2]),s=e[3],c=a.comment;return c.secureComment&&(o="string"==typeof c.secureComment?c.secureComment:c.secureComment.content),o||(o=c.content||c.comment),c.rawComment&&(m="string"==typeof c.rawComment?c.rawComment:c.rawComment.content),m||(m=c.content||c.comment),n.getModel("person-models",t.authorId).then(function(e){return r=l.addOrUpdate({id:c.commentId,galleryId:c.galleryId,galleryOwnerId:c.galleryOwnerId,author:e,authorUsername:c.authorname,authorId:c.author,date:c.dateCreate,permalink:c.permalink,content:c.content,contentSecure:o,contentRaw:m}),s.getValue("comments").unshift(r),s.getValue("comments").totalItems++,s.setValue("commentCount",s.getValue("commentCount")+1),r})}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-galleries-comments-deleteComment-deletor",function(e,o){"use strict";e.namespace("ModelDeletors")["flickr-galleries-comments-deleteComment"]={run:function(t,r){var l=this;return e.Promise.all([r.callAPI("flickr.galleries.comments.deleteComment",this._processParams(t)),r.getModel("gallery-info-models",t.galleryId)]).then(function(e){l._processResponse(e,t,r)},e.FetcherErrorLogger(o))},_processParams:function(e){return{comment_id:e.commentId,gallery_id:e.galleryId,owner_id:e.ownerId}},_processResponse:function(e,o,t){e[0];var r=e[1];r.getValue("comments").removeFromList(o.commentId),r.getValue("comments").totalItems--,r.setValue("commentCount",r.getValue("commentCount")-1)}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-galleries-comments-editComment-updater",function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-galleries-comments-editComment"]={run:function(n,o){var r=this;return e.Promise.all([o.callAPI("flickr.galleries.comments.editComment",this._processParams(n)),o.getModel("gallery-comment-models",n.commentId)]).then(function(e){return r._processResponse(e,n,o)},e.FetcherErrorLogger(t))},_processParams:function(e){return{comment_id:e.commentId,gallery_id:e.galleryId,owner_id:e.ownerId,comment_text:e.content,extras:"full_response, expand_bbml"}},_processResponse:function(e,t,n){var o,r,m=e[0].comment||{content:""},c=e[1];return m.secureComment&&(o="string"==typeof m.secureComment?m.secureComment:m.secureComment.content),o||(o=m.content||m.comment),m.rawComment&&(r="string"==typeof m.rawComment?m.rawComment:m.rawComment.content),r||(r=m.content||m.comment),c.setValues({content:t.content,contentSecure:o,contentRaw:r}),c}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("gallery-comment-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{create:function(t){return e.ModelCreators["flickr-galleries-comments-addComment"].run(t,this.appContext)},delete:function(t,r){return e.ModelDeletors["flickr-galleries-comments-deleteComment"].run(t,r)},update:function(t,r){return e.ModelUpdaters["flickr-galleries-comments-editComment"].run({commentId:t.commentId,galleryId:t.galleryId,ownerId:t.ownerId,content:t.content},r)}},updateRemote:function(e,t){return this.remote.update({commentId:e,galleryId:this.getValue(e,"galleryId"),ownerId:this.getValue(e,"galleryOwnerId"),content:t},this.appContext)},deleteRemote:function(e){return this.remote.delete({commentId:e,galleryId:this.getValue(e,"galleryId"),ownerId:this.getValue(e,"galleryOwnerId")},this.appContext)},attributes:{id:{},galleryId:{},galleryOwnerId:{},author:{isModel:!0},authorUsername:{},authorId:{},date:{},timeago:{readOnly:!0,derivedBy:["date"],getter:function(t,r){return e.moment.unix(this.getValue(r,"date"))}},permalink:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},content:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},contentSecure:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},contentRaw:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","moment","flickr-galleries-comments-addComment-creator","flickr-galleries-comments-deleteComment-deletor","flickr-galleries-comments-editComment-updater"]});YUI.add("flickr-galleries-comments-getList-fetcher",function(e,t){"use strict";e.namespace("ListFetchers")["flickr-galleries-comments-getList"]={run:function(r,o){var n=this,s=this._processParams(r);return e.FlickrPromise({apiResponse:o.callAPI("flickr.galleries.comments.getList",s),galleryInfoModelRegistry:o.getModelRegistry("gallery-info-models"),galleryCommentModelRegistry:o.getModelRegistry("gallery-comment-models"),personModelRegistry:o.getModelRegistry("person-models")}).then(function(e){return n._processResponse(e,r,o)},e.FetcherErrorLogger(t))},_processResponse:function(t,r,o){var n,s,a=t.apiResponse,l=t.galleryInfoModelRegistry,m=t.galleryCommentModelRegistry,i=t.personModelRegistry,c=[];return a.comments&&(a.comments.comment.forEach(function(t,r){var o=i.addOrUpdate(e.APIHelper.response.parsePerson({nsid:t.author,isDeleted:t.authorIsDeleted,pathAlias:t.pathAlias,username:t.authorname,realname:t.realname,isAdFree:t.isAdFree,ispro:t.ispro,proBadge:t.proBadge,iconurls:t.iconurls,location:t.location}));t.secureComment&&(n="string"==typeof t.secureComment?t.secureComment:t.secureComment.content),n||(n=t.content||t.comment),t.rawComment&&(s="string"==typeof t.rawComment?t.rawComment:t.rawComment.content),s||(s=t.content||t.comment),c.push(m.addOrUpdate({id:t.commentId,galleryId:t.galleryId,galleryOwnerId:t.galleryOwnerId,author:o,authorUsername:t.authorname,authorId:t.author,date:t.dateCreate,permalink:t.permalink,content:t.content,contentSecure:n,contentRaw:s}))}),l.getValue(r.id,"comments").concat(c),l.getValue(r.id,"comments").totalItems=parseInt(a.comments.total||0,10),l.setValue(r.id,"commentsContinuation",a.comments.continuation)),c},_processParams:function(e){return{gallery_id:e.id,page:e.page||1,per_page:e.perPage||16,secure_image_embeds:e.secureImageEmbeds||1,extras:"icon_urls, expand_bbml",sort:e.sort||"date-posted-desc",continuation:e.continuation||0}}}},"@VERSION@",{requires:["flickr-promise","api-helper","url-helper"],optional:["gallery-info-models","person-models","gallery-comment-models"]});